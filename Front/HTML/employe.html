<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Good Services - Employés</title>
    <link rel="stylesheet" href="../css/employe.css">
    <script src="./../js/employes.js"></script>
    <script>
        function searchEmployee() {
            const searchInput = document.getElementById("search-input").value.toLowerCase();
            const rows = document.querySelectorAll("#employee-table tbody tr");

            rows.forEach(row => {
                const nameCell = row.querySelector("td:nth-child(2)").textContent.toLowerCase();
                const roleCell = row.querySelector("td:nth-child(6)").textContent.toLowerCase();

                if (nameCell.includes(searchInput) || roleCell.includes(searchInput)) {
                    row.style.display = "";
                } else {
                    row.style.display = "none";
                }
            });
        }
    </script>
</head>
<body>
    <header>
        <div class="logo">Good Services</div>
        <nav>
            <ul>
                <li><a href="admin.html">Accueil</a></li>
                <li><a href="employe.html">Employés</a></li>
                <li><a href="chantier.html">Chantier</a></li>
                <li><a href="weekly-report.html">Rapport hebdomadaire</a></li>
            </ul>
        </nav>
    </header>

    <section>
        <h2>Liste des Employés</h2>

        <!-- Barra de búsqueda y botón de añadir empleado -->
        <div class="search-bar">
            <input type="text" id="search-input" placeholder="Rechercher un employé..." onkeyup="searchEmployee()" />
            <button onclick="window.location.href='add_employe.html';">Ajouter un employé</button>
        </div>

        <table id="employee-table">
            <thead>
                <tr>
                    <th>CDI</th>
                    <th>Nom</th>
                    <th>Prénom</th>
                    <th>Email</th>
                    <th>Téléphone</th>
                    <th>Rôle</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="employes">
                <!-- Aquí estarán los empleados extraídos de la base de datos -->
                
            </tbody>
        </table>
    </section>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Seleccionar todos los botones "Modifier"
            document.querySelectorAll(".action-buttons button:nth-child(1)").forEach(button => {
                button.addEventListener("click", function () {
                    let row = this.closest("tr"); // Obtener la fila del empleado
                    let id = row.cells[0].textContent; // Obtener el ID del empleado (CDI)
                    alert("Modifier l'employé avec ID: " + id);
                    // Aquí puedes redirigir a la página de modificación o abrir un formulario modal
                    window.location.href = "edit_employe.html?id=" + id;
                });
            });
    
            // Seleccionar todos los botones "Supprimer"
            document.querySelectorAll(".action-buttons button:nth-child(2)").forEach(button => {
                button.addEventListener("click", function () {
                    let row = this.closest("tr"); // Obtener la fila del empleado
                    let id = row.cells[0].textContent; // Obtener el ID del empleado (CDI)
    
                    if (confirm("Voulez-vous vraiment supprimer l'employé avec ID " + id + " ?")) {
                        // Aquí se debe hacer una petición al servidor para eliminar al empleado
                        alert("L'employé " + id + " a été supprimé !");
                        row.remove(); // Elimina la fila visualmente (pero no de la base de datos)
                    }
                });
            });
        });
    </script>
    

    <footer>
        <p>&copy; 2025 Good Services. Tous droits réservés.</p>
    </footer>
</body>
</html>








